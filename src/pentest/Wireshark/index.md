# Wireshark

## Description

Wireshark is an open-source tool for capturing and analyzing network packets. This tool is primarily used to capture network traffic on a machine’s interfaces. These captures can then be saved in PCAP files (with a .pcap extension) for analysis.


## Installation

- For Linux (Debian/Ubuntu) :
    
```shell
sudo apt-get install wireshark
```

- For Windows : you can download the installer from the official website (https://www.wireshark.org/download.html) and follow the installation instructions.

## Use cases

- **Network troubleshooting** : to identify and resolve network issues such as packet loss, delays, and configuration errors.

- **Network security** : in the context of intrusion detection, malware analysis, and network security monitoring to detect flows related to suspicious activities.

## Main features

- **Advanced filtering** : allows filtering packets based on criteria such as IP address, port, protocol, etc., to focus on specific elements.
- **Detailed analysis** : provides in-depth packet analysis, including header inspection, data stream tracking, session reconstruction, etc.
- **Support for numerous protocols** : supports a wide range of network protocols, such as TCP, UDP, HTTP, DNS, FTP, and many more.
- **Data export** : analysis results can be exported in various formats such as CSV, XML, and PCAP.
- **Graphs and statistics** : allows you to generate graphs and statistics to visualize network performance.

## TShark

"TShark" is a CLI version of Wireshark, providing the same capabilities for recording and analyzing network captures, but through the command line only. TShark can be useful in many cases, including :

- Automated processing via scripts ;
- Data extraction ;
- Server usage ;
- ...

## How it works


### Example of Usage

Suppose you are facing latency issues on a local network, you can launch Wireshark and select the network interface to monitor.
By applying a filter to capture only relevant traffic and filtering traffic to or from a specific IP address, for example, you can analyze the results to identify sources of latency, such as transmission delays or packet losses.

- Analysis of Captured Data Packets on a Network
- Data Flow Tracking Feature (UDP, TCP...)
- Packet Filtering by IP Address
- In-Depth Analysis of a Frame
- Usage of TShark


Here is an example of using tshark, let’s imagine a significant network capture with a large number of packets, but we are only interested in the DNS and HTTP protocols. We can extract packets containing these protocols into a new capture using Tshark :

```shell
4 tshark -r capture_example.pcapng -Y 'http || dns' -w out.pcapng
```

We can then read the capture with tshark :

```shell
$ tshark -r out.pcapng

1 0.000000000 192.168.121.3 → 192.168.202.49 DNS 103 Standard query response 0x6f3d A lost.com A 104.21.5.178 A 172.67.133.176
2 0.000000209 192.168.121.3 → 192.168.202.49 DNS 127 Standard query response 0x8802 AAAA lost.com AAAA 2606:4700:3033::6815:5b2 AAAA 2606:4700:3037::ac43:85b0
3 0.009499422 192.168.5.74 → 104.21.5.178 HTTP 141 GET / HTTP/1.1
4 0.377068826 104.21.5.178 → 192.168.5.74 HTTP 73 Continuation
```

## Tips

- Display only TCP payload

Filter -> `tcp.payload`